---
import { Heart } from "lucide-astro";
import { getLangFromUrl, useTranslations } from "@/i18n/utils";
import sponsorsData from "@/data/sponsors.json";

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const SPONSORS = (sponsorsData && sponsorsData.sponsors) || [];
---

<section class="flex w-full flex-col">
  <header class="mb-5 flex flex-col gap-2">
    <div class="flex items-center justify-between">
      <h2
        class="flex items-center gap-x-2 text-lg font-semibold text-foreground"
      >
        <Heart class="size-5" />{t("landing.sponsors.title")}
      </h2>
    </div>
    <p class="text-muted-foreground">{t("landing.sponsors.subtitle")}</p>
  </header>

  {
    SPONSORS.length > 0 ? (
      <div class="grid grid-cols-2 gap-4 sm:grid-cols-3 lg:grid-cols-4">
        {SPONSORS.map(({ name, href, logo, avatar, tier }) => (
          <a
            href={href}
            target="_blank"
            rel="noopener noreferrer"
            class="flex items-center justify-center rounded-2xl border bg-card p-4 transition-colors hover:border-primary"
          >
            {logo || avatar ? (
              <img src={logo || avatar} alt={name} class="h-8" />
            ) : (
              <span class="font-medium text-foreground">{name}</span>
            )}
          </a>
        ))}
      </div>
    ) : (
      <div class="flex flex-col items-center justify-center gap-4 rounded-2xl border bg-card p-8 text-center">
        <p class="text-muted-foreground">{t("landing.sponsors.empty")}</p>
        <a
          href="https://github.com/sponsors/bjohansebas"
          target="_blank"
          class="inline-flex items-center gap-2 rounded-lg border border-pink-500 bg-pink-500/10 px-4 py-2 text-sm font-medium text-pink-500 transition-colors hover:bg-pink-500/20"
        >
          <Heart class="size-4" fill="currentColor" />
          {t("landing.sponsors.become")}
        </a>
      </div>
    )
  }
</section>
